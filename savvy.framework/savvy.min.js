/*

   .x+=:.                  _            _                      
  z`    ^%                u            u            ..         
     .   <k              88Nu.   u.   88Nu.   u.   @L          
   .@8Ned8"       u     '88888.o888c '88888.o888c 9888i   .dL  
 .@^%8888"     us888u.   ^8888  8888  ^8888  8888 `Y888k:*888. 
x88:  `)8b. .@88 "8888"   8888  8888   8888  8888   888E  888I 
8888N=*8888 9888  9888    8888  8888   8888  8888   888E  888I 
 %8"    R88 9888  9888    8888  8888   8888  8888   888E  888I 
  @8Wou 9%  9888  9888   .8888b.888P  .8888b.888P   888E  888I 
.888888P`   9888  9888    ^Y8888*""    ^Y8888*""   x888N><888' 
`   ^"F     "888*""888"     `Y"          `Y"        "88"  888  
             ^Y"   ^Y'                                    88F  
                                                         98"   
                                                       ./"     
                                                      ~`       

   Version: 0.3.0

   Copyright 2014 Oliver Moran

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.

*/

'use strict';var Card;(function(a){a.READY="savvy-ready";a.ENTER="savvy-enter";a.EXIT="savvy-exit";a.LOAD="savvy-load"})(Card||(Card={}));var JXON;
(function(a){function b(a){function q(a){return/^\s*$/.test(a)?null:/^(?:true|false)$/i.test(a)?"true"===a.toLowerCase():isFinite(a)?parseFloat(a):a}var k=new g,p=0,m="";if(a.attributes&&0<a.attributes.length)for(p;p<a.attributes.length;p++){var e=a.attributes.item(p);k["@"+e.name.toLowerCase()]=q(e.value.trim())}if(a.childNodes&&0<a.childNodes.length)for(var c,d=0;d<a.childNodes.length;d++)c=a.childNodes.item(d),4===c.nodeType?m+=c.nodeValue:3===c.nodeType?m+=c.nodeValue.trim():1!==c.nodeType||c.prefix||
(0===p&&(k={}),e=c.nodeName.toLowerCase(),c=b(c),k.hasOwnProperty(e)?(k[e].constructor!==Array&&(k[e]=[k[e]]),k[e].push(c)):(k[e]=c,p++));k.constructor===g&&k.setValue(q(m));0<p&&Object.freeze(k);return k}a.parse=function(a){return b(a)};var g=function(){function a(b){this._value=void 0===b?null:b}a.prototype.setValue=function(a){this._value=a};a.prototype.valueOf=function(){return this._value};a.prototype.toString=function(){return null===this._value?"null":this._value.toString()};return a}()})(JXON||
(JXON={}));var application;
(function(a){a.id=null;a.isCordova=!1;a.version=null;a.cards=[];a.defaultCard=null;a.currentCard=null;a.goto=function(a,g,r){throw"application.goto has not been over-written. Is there a problem with the order that Savvy is built?";};a.getRoute=function(){var b=window.location.hash;return""==b||"#"==b||"#!"==b||"#!/"==b?a.defaultCard.id:b.substr(3)};a.offCanvas=function(a){var g=document.body.querySelector("main");"undefined"==typeof a&&(a=""==g.style.left||"0px"==g.style.left?Transition.OFF_CANVASS_LEFT:
"0px");g.style.left==a&&(a="0px");g.style.left=a}})(application||(application={}));var Savvy;
(function(a){function b(c,b,n){[].concat(c.css||[]).forEach(function(a){var c=d.isRemoteUrl.test(a)||-1!=window.navigator.appVersion.indexOf("MSIE 8");if(c&&n)throw"Card styles sheets cannot be remote (e.g. http://www.examples.com/style.css). Please include remote style sheets globally.";var b;c?(b=document.createElement("link"),b.setAttribute("rel","stylesheet"),b.setAttribute("type","text/css"),b.setAttribute("href",a)):(b=document.createElement("style"),b.setAttribute("type","text/css"));n&&b.setAttribute("data-for",
n);try{if(!c){var s=r(a);n&&(s=s.replace(d.css.body,"$1"),s=s.replace(d.css.selector,"body > main > div > section#"+n+" $1$2"));var f=a.toString().lastIndexOf("/");if(-1!=f)var k=a.toString().substr(0,f+1),s=s.replace(d.css.noQuotes,"url("+k).replace(d.css.doubleQuotes,'url("'+k).replace(d.css.singleQuotes,"url('"+k);b.appendChild(document.createTextNode(s))}document.getElementsByTagName("head")[0].appendChild(b)}catch(e){throw"Error appending CSS file ("+a+"): "+e.toString();}});[].concat(c.html||
[]).forEach(function(a){b.insertAdjacentHTML("beforeend",r(a))});[].concat(c.json||[]).forEach(function(a){var c=a["@target"];if("string"==typeof c)a:{var d=b==document.body?window:b;"undefined"===typeof d&&(d=window);var f;try{var n=r(a);f=JSON.parse(n)}catch(k){console.error('Cannot parse data file ("'+a+'"). Please check that the file is valid JSON <http://json.org/>.');break a}try{a=f;f=d;"undefined"===typeof f&&(f=window);for(var e=c.split("."),n=0;n<e.length-1;n++){var l=e[n];"undefined"==typeof f[l]&&
(f[l]={});f=f[l]}f[e[n]]=a}catch(g){console.error("Could not create object: "+(d==window?"window.":"this.")+c)}}else console.error('No target attribute provided for JSON ("'+b+'")')});[].concat(c.js||[]).forEach(function(c){var d=b==document.body?window:b,f=g(c);try{a._eval(f,d)}catch(n){throw n.toString()+" ("+c+")";}})}function g(a){return r(a).replace(l,function(c,d){for(var b=a.toString().lastIndexOf("/"),b=(a.toString().substr(0,b+1)+d).split("/"),h=1;h<b.length;)if(!(0>h)){".."==b[h]&&".."!==
b[h-1]&&0<h&&(b.splice(h-1,2),h-=2);if("."===b[h]||""==b[h])b.splice(h,1),h-=1;h++}b=b.join("/");return g(b)})}function r(a,c){"undefined"===typeof c&&(c=!1);var b=new XMLHttpRequest;b.open("GET",a,!1);b.setRequestHeader("Cache-Control","no-store");b.send();return 200!==b.status&&0!==b.status?(console.error("HTTP status "+b.status+" returned for file: "+a),null):c?b.responseXML:b.responseText}var q=JXON.parse(r("app.xml",!0));if(void 0===q.app)throw'Could not parse app.xml. "app" node missing.';application.id=
q.app["@id"]?q.app["@id"]:"application";application.version=q.app["@version"]?q.app["@version"]:"";application.isCordova="yes"==q.app["@cordova"];var k="load",p=window;if(application.isCordova){var k="deviceready",p=document,m=document.createElement("script");m.setAttribute("src","cordova.js");m.setAttribute("type","text/javascript");var e=document.createElement("script");e.setAttribute("src","cordova_plugins.js");e.setAttribute("type","text/javascript");document.head.appendChild(m);document.head.appendChild(e)}p.addEventListener(k,
function v(){p.removeEventListener(k,v);for(var d=q.app,e=[].concat(d.img||[]),h=0,l=e.length;h<l;h++){var g=new Image;g.src=e[h];c.push(g)}b(d,document.body);e=document.createElement("main");document.body.appendChild(e);d.header&&(h=document.createElement("header"),b(d.header,h),e.appendChild(h));h=[].concat(d.card||[]);l=document.createElement("div");e.appendChild(l);for(var g=0,r=h.length;g<r;g++){var m=h[g],u=m["@id"],w=m["@title"],t=document.createElement("section");t.setAttribute("id",u);t.setAttribute("title",
w);window[u]=t;application.cards.push(t);void 0!==m["@default"]&&(null===application.defaultCard?application.defaultCard=t:console.warn("More than one card is set as the default in app.xml. Ignoring."));b(m,t,u);l.appendChild(t)}if(null===application.defaultCard)throw"No default card set.";d.footer&&(h=document.createElement("footer"),b(d.footer,h),e.appendChild(h));delete a._eval;application.goto(application.getRoute(),Transition.CUT,!0)},!1);var c=[],d={isRemoteUrl:/(http|ftp|https):\/\/[a-z0-9-_]+(.[a-z0-9-_]+)+([a-z0-9-.,@?^=%&;:/~+#]*[a-z0-9-@?^=%&;/~+#])?/i,
css:{singleQuotes:/url\('(?!https?:\/\/)(?!\/)/gi,doubleQuotes:/url\("(?!https?:\/\/)(?!\/)/gi,noQuotes:/url\((?!https?:\/\/)(?!['"]\/?)/gi,body:/\bbody\b(,(?=[^}]*{)|\s*{)/gi,selector:/([^\r\n,{}]+)(,(?=[^}]*{)|\s*{)/gi}},l=/^#include "(.*)"$/gm})(Savvy||(Savvy={}));
(function(a){function b(a){var b=a.indexOf("/");return-1<b?a.substr(0,b):a}function g(c,b,l){c.to&&(c.to.style.setProperty("visibility","hidden","important"),c.to.style.setProperty("display","block","important"));var f=k(c,b,l);f.initCustomEvent(Card.READY,!0,!0,c);c.to.dispatchEvent(f);f.defaultPrevented?e=r:r.call(a,c,b,l)}function r(a,b,l){e=m;a.to&&a.to.style.setProperty("visibility","visible","important");a.transition||(a.transition=Transition.CUT);q(a.to,a.transition.to,a.transition.duration);
q(a.from,a.transition.from,a.transition.duration);setTimeout(function(){a.from&&a.from.style.removeProperty("display");a.to&&a.to.style.removeProperty("visibility");document.title=a.to.title||"";l||(p=!0,window.location.hash="!/"+b);var f=k(a,b,l);application.currentCard=a.to;f.initCustomEvent(Card.ENTER,!0,!0,a);a.to.dispatchEvent(f)},a.transition.duration)}function q(a,b,e){null!=a&&(a.className+=b,setTimeout(function(){a.className=a.className.replace(b,"")},e))}function k(b,d,g){var f=document.createEvent("CustomEvent");
e=m;f["continue"]=function(){e.call(a,b,d,g)};return f}application["goto"]=function(c,d,l){"undefined"===typeof d&&(d=Transition.CUT);"undefined"===typeof l&&(l=!1);if("string"==typeof c){"undefined"===typeof d&&(d=Transition.CUT);"undefined"===typeof l&&(l=!1);var f=b(c),m=document.getElementById(f),n=application.currentCard;if(-1<application.cards.indexOf(m))d={from:n,to:m,transition:d},f=k(d,c,l),null==d.from?(f.initCustomEvent(Card.LOAD,!0,!0,d),document.body.dispatchEvent(f)):(f.initCustomEvent(Card.EXIT,
!0,!0,d),d.from.dispatchEvent(f)),f.defaultPrevented?e=g:g.call(a,d,c,l);else throw'No card with ID of "'+f+'".';}else throw"A string indicating a card ID must be passed to document.goto method.";};var p=!1;window.addEventListener("hashchange",function(){if(p)p=!1;else{var a=application.getRoute(),d=b(a),d=document.getElementById(d);console.log(application.cards.indexOf(d));-1<application.cards.indexOf(d)&&application.goto(a,Transition.CUT,!0)}},!1);var m=function(){},e=m})(Savvy||(Savvy={}));var Transition;
(function(a){a.CUT={from:"transition -d0ms -static",to:"transition -d0ms -static",duration:0,inverse:null};a.SLIDE_LEFT={from:"transition -d333ms -ease-in-out -out -left",to:"transition -d333ms -ease-in-out -in -left",duration:333,inverse:null};a.SLIDE_RIGHT={from:"transition -d500ms -ease-in-out -out -right",to:"transition -d500ms -ease-in-out -in -right",duration:500,inverse:null};a.COVER_LEFT={from:"transition -d250ms -static -lower",to:"transition -d250ms -ease-in-out -in -left -shadow",duration:250,
inverse:null};a.COVER_RIGHT={from:"transition -d250ms -static -lower",to:"transition -d250ms -ease-in-out -in -right -shadow",duration:250,inverse:null};a.UNCOVER_LEFT={from:"transition -d333ms -ease-in-out -out -left -shadow",to:"transition -d333ms -static -lower",duration:333,inverse:null};a.UNCOVER_RIGHT={from:"transition -d333ms -ease-in-out -out -right -shadow",to:"transition -d333ms -static -lower",duration:333,inverse:null};a.COVER_LEFT_FADE={from:"transition -d1000ms -linear -out -left -fade -lower",
to:"transition -d250ms -ease-in-out -in -left -shadow",duration:250,inverse:null};a.COVER_RIGHT_FADE={from:"transition -d1000ms -linear -out -right -fade -lower",to:"transition -d250ms -ease-in-out -in -right -shadow",duration:250,inverse:null};a.UNCOVER_LEFT_FADE={from:"transition -d333ms -ease-in-out -out -left -shadow",to:"transition -d333ms -linear -in -right -fade -lower",duration:333,inverse:null};a.UNCOVER_RIGHT_FADE={from:"transition -d333ms -ease-in-out -out -right -shadow",to:"transition -d333ms -linear -in -right -fade -lower",
duration:333,inverse:null};a.CUT.inverse=a.CUT;a.SLIDE_LEFT.inverse=a.SLIDE_RIGHT;a.SLIDE_RIGHT.inverse=a.SLIDE_LEFT;a.COVER_LEFT.inverse=a.UNCOVER_RIGHT;a.COVER_RIGHT.inverse=a.UNCOVER_LEFT;a.UNCOVER_LEFT.inverse=a.COVER_RIGHT;a.UNCOVER_RIGHT.inverse=a.COVER_LEFT;a.COVER_LEFT_FADE.inverse=a.UNCOVER_RIGHT_FADE;a.COVER_RIGHT_FADE.inverse=a.UNCOVER_LEFT_FADE;a.UNCOVER_LEFT_FADE.inverse=a.COVER_RIGHT_FADE;a.UNCOVER_RIGHT_FADE.inverse=a.COVER_LEFT_FADE;a.OFF_CANVASS_LEFT="260px";a.OFF_CANVASS_RIGHT="-260px"})(Transition||
(Transition={}));(function(a){a._eval=function(a,g){void 0===g?(window.execScript||function(a){window.eval.call(window,a)})(a):function(a){eval(a)}.call(g,a)}})(Savvy||(Savvy={}));
